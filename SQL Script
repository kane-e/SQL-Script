-- BEGIN HERE --


-- Find & insert avg % of contacts active per firm size

SELECT * FROM METRICS2; 

UPDATE METRICS2
SET AVG_ACTIVATION = 
(select ROUND(avg(PCT_ACTIVE), 0)
from metrics2
WHERE EMPLOYEE_COUNT BETWEEN 0 AND 4)
WHERE EMPLOYEE_COUNT BETWEEN 0 AND 4;

UPDATE METRICS2
SET AVG_ACTIVATION = 
(select ROUND(avg(PCT_ACTIVE), 0)
from metrics2
WHERE EMPLOYEE_COUNT BETWEEN 5 AND 10)
WHERE EMPLOYEE_COUNT BETWEEN 5 AND 10;


UPDATE METRICS2
SET AVG_ACTIVATION = 
(select ROUND(avg(PCT_ACTIVE), 0)
from metrics2
WHERE EMPLOYEE_COUNT > 10)
WHERE EMPLOYEE_COUNT > 10;




-- Find & insert avg total file uploads per firm size

UPDATE METRICS2 
SET AVG_FILES = (select ROUND(avg(FILES_UPLOADED_TOTAL))
from metrics2
WHERE EMPLOYEE_COUNT BETWEEN 0 AND 4)
WHERE EMPLOYEE_COUNT BETWEEN 0 AND 4;

UPDATE METRICS2 
SET AVG_FILES = (select ROUND(avg(FILES_UPLOADED_TOTAL))
from metrics2
WHERE EMPLOYEE_COUNT BETWEEN 5 AND 10)
WHERE EMPLOYEE_COUNT BETWEEN 5 AND 10;


UPDATE METRICS2 
SET AVG_FILES = (select ROUND(avg(FILES_UPLOADED_TOTAL))
from metrics2
WHERE EMPLOYEE_COUNT > 10)
WHERE EMPLOYEE_COUNT > 10;




-- Find & insert avg messages per firm size

UPDATE METRICS2 
SET AVG_MESSAGES = (select ROUND(avg(TOTAL_MESSAGES))
from metrics2
WHERE EMPLOYEE_COUNT BETWEEN 0 AND 4)
WHERE EMPLOYEE_COUNT BETWEEN 0 AND 4;

UPDATE METRICS2 
SET AVG_MESSAGES = (select ROUND(avg(TOTAL_MESSAGES))
from metrics2
WHERE EMPLOYEE_COUNT BETWEEN 5 AND 10)
WHERE EMPLOYEE_COUNT BETWEEN 5 AND 10;


UPDATE METRICS2 
SET AVG_MESSAGES = (select ROUND(avg(TOTAL_MESSAGES))
from metrics2
WHERE EMPLOYEE_COUNT > 10)
WHERE EMPLOYEE_COUNT > 10;



--Find & insert avg tasks completed per firm size 


UPDATE METRICS2 
SET AVG_TASKS = (select ROUND(avg(TASKS_ClOSED_BY_CLIENTS))
from metrics2
WHERE EMPLOYEE_COUNT BETWEEN 0 AND 4)
WHERE EMPLOYEE_COUNT BETWEEN 0 AND 4;

UPDATE METRICS2 
SET AVG_TASKS = (select ROUND(avg(TASKS_ClOSED_BY_CLIENTS))
from metrics2
WHERE EMPLOYEE_COUNT BETWEEN 5 AND 10)
WHERE EMPLOYEE_COUNT BETWEEN 5 AND 10;


UPDATE METRICS2 
SET AVG_TASKS = (select ROUND(avg(TASKS_ClOSED_BY_CLIENTS))
from metrics2
WHERE EMPLOYEE_COUNT > 10)
WHERE EMPLOYEE_COUNT > 10;



-- Find & insert Client App Downloads per firm size 

UPDATE METRICS2 
SET AVG_CLIENT_APPS = (select ROUND(avg(CLIENT_APP_PERCENT))
from metrics2
WHERE EMPLOYEE_COUNT BETWEEN 0 AND 4)
WHERE EMPLOYEE_COUNT BETWEEN 0 AND 4;

UPDATE METRICS2 
SET AVG_CLIENT_APPS = (select ROUND(avg(CLIENT_APP_PERCENT))
from metrics2
WHERE EMPLOYEE_COUNT BETWEEN 5 AND 10)
WHERE EMPLOYEE_COUNT BETWEEN 5 AND 10;


UPDATE METRICS2 
SET AVG_CLIENT_APPS = (select ROUND(avg(CLIENT_APP_PERCENT))
from metrics2
WHERE EMPLOYEE_COUNT > 10)
WHERE EMPLOYEE_COUNT > 10;

-- Find & insert FirmDash Downloads per firm size 

UPDATE METRICS2 
SET AVG_FIRMDASH = (select ROUND(avg(FIRMDASH_PERCENT))
from metrics2
WHERE EMPLOYEE_COUNT BETWEEN 0 AND 4)
WHERE EMPLOYEE_COUNT BETWEEN 0 AND 4;

UPDATE METRICS2 
SET AVG_FIRMDASH = (select ROUND(avg(FIRMDASH_PERCENT))
from metrics2
WHERE EMPLOYEE_COUNT BETWEEN 5 AND 10)
WHERE EMPLOYEE_COUNT BETWEEN 5 AND 10;


UPDATE METRICS2 
SET AVG_FIRMDASH = (select ROUND(avg(FIRMDASH_PERCENT))
from metrics2
WHERE EMPLOYEE_COUNT > 10)
WHERE EMPLOYEE_COUNT > 10;

--Find & insert avg eDocs per firm size 


UPDATE METRICS2 
SET AVG_EDOCS = (select ROUND(avg(EDOCS_SENT))
from metrics2
WHERE EMPLOYEE_COUNT BETWEEN 0 AND 4)
WHERE EMPLOYEE_COUNT BETWEEN 0 AND 4;

UPDATE METRICS2 
SET AVG_EDOCS = (select ROUND(avg(EDOCS_SENT))
from metrics2
WHERE EMPLOYEE_COUNT BETWEEN 5 AND 10)
WHERE EMPLOYEE_COUNT BETWEEN 5 AND 10;


UPDATE METRICS2 
SET AVG_EDOCS = (select ROUND(avg(EDOCS_SENT))
from metrics2
WHERE EMPLOYEE_COUNT > 10)
WHERE EMPLOYEE_COUNT > 10;





--Find & insert avg CST for all firm sizes 


UPDATE METRICS2 
SET AVG_CST = (select ROUND(avg(TM_ACCOUNTS_PCT))
from metrics2
WHERE EMPLOYEE_COUNT BETWEEN 0 AND 4)
WHERE EMPLOYEE_COUNT BETWEEN 0 AND 4;

UPDATE METRICS2 
SET AVG_CST = (select ROUND(avg(TM_ACCOUNTS_PCT))
from metrics2
WHERE EMPLOYEE_COUNT BETWEEN 5 AND 10)
WHERE EMPLOYEE_COUNT BETWEEN 5 AND 10;


UPDATE METRICS2 
SET AVG_CST = (select ROUND(avg(TM_ACCOUNTS_PCT))
from metrics2
WHERE EMPLOYEE_COUNT > 10)
WHERE EMPLOYEE_COUNT > 10;


